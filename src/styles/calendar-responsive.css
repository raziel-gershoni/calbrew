/* Responsive Calendar Cell Content Based on Computed Dimensions */

/* Base calendar cell styles */
.calendar-cell {
  @apply w-full relative;
  container-type: size;
}

/* Content layout strategies based on cell dimensions */
.calendar-cell-content {
  @apply h-full flex flex-col p-1;
}

/* Default styles for all cell elements */
.calendar-cell-primary-date {
  @apply text-sm font-bold;
}

.calendar-cell-secondary-date {
  @apply text-xs opacity-60;
}

.calendar-cell-secondary-month {
  @apply text-xs opacity-60 hidden;
}

.calendar-cell-events {
  @apply flex flex-col gap-0.5 mt-1 flex-1;
}

.calendar-cell-event {
  @apply text-xs bg-blue-100 text-blue-800 p-0.5 mb-0.5 rounded truncate cursor-pointer hover:bg-blue-200;
}

.calendar-cell-event-indicator {
  @apply w-1.5 h-1.5 bg-blue-500 rounded-full block;
}

.calendar-cell-event-count {
  @apply text-xs opacity-60;
}

/* Very small cells (< 40px height) - minimal inline layout */
@container (max-height: 40px) {
  .calendar-cell-content {
    @apply flex-row items-center justify-between p-0.5;
  }

  .calendar-cell-primary-date {
    @apply text-xs font-bold;
  }

  .calendar-cell-secondary-date {
    @apply text-xs;
  }

  .calendar-cell-events {
    @apply flex-row items-center gap-1 mt-0 justify-end;
  }

  .calendar-cell-event {
    @apply hidden;
  }

  .calendar-cell-event-indicator {
    @apply hidden;
  }

  .calendar-cell-event-count {
    @apply hidden;
  }

  .calendar-cell-event-badge {
    @apply flex items-center justify-center w-4 h-4 bg-blue-500 text-white rounded-full text-xs font-medium min-w-[1rem];
  }
}

/* Small cells (40-60px height) - compact column layout */
@container (min-height: 40px) and (max-height: 60px) {
  .calendar-cell-content {
    @apply flex-row items-start justify-between p-0.5;
  }

  /* Date column (left in LTR, right in RTL) */
  .calendar-cell-date-column {
    @apply flex flex-col items-start flex-shrink-0;
  }

  .calendar-cell-primary-date {
    @apply text-sm font-bold leading-tight;
  }

  .calendar-cell-secondary-date {
    @apply text-xs opacity-70 leading-tight;
  }

  /* Events column (right in LTR, left in RTL) - badges at top */
  .calendar-cell-events {
    @apply flex flex-row items-start justify-end flex-1;
  }

  .calendar-cell-event {
    @apply hidden;
  }

  .calendar-cell-event-indicator {
    @apply hidden;
  }

  .calendar-cell-event-count {
    @apply hidden;
  }

  .calendar-cell-event-badge {
    @apply flex items-center justify-center w-[18px] h-[18px] bg-blue-500 text-white rounded-full text-xs font-medium min-w-[18px];
  }
}

/* Medium cells (60-75px height) - compact column layout with more space */
@container (min-height: 60px) and (max-height: 75px) {
  .calendar-cell-content {
    @apply flex-row items-start justify-between p-0.5;
  }

  /* Date column (left in LTR, right in RTL) */
  .calendar-cell-date-column {
    @apply flex flex-col items-start flex-shrink-0;
  }

  .calendar-cell-primary-date {
    @apply text-base font-bold leading-tight;
  }

  .calendar-cell-secondary-date {
    @apply text-sm opacity-70 leading-tight;
  }

  /* Events column (right in LTR, left in RTL) */
  .calendar-cell-events {
    @apply flex flex-row items-start justify-end flex-1;
  }

  .calendar-cell-event {
    @apply hidden;
  }

  .calendar-cell-event-indicator {
    @apply hidden;
  }

  .calendar-cell-event-count {
    @apply hidden;
  }

  .calendar-cell-event-badge {
    @apply flex items-center justify-center w-[18px] h-[18px] bg-blue-500 text-white rounded-full text-xs font-medium min-w-[18px];
  }
}

/* Large cells (75-100px height) - show some event titles */
@container (min-height: 75px) and (max-height: 100px) {
  .calendar-cell-content {
    @apply flex-col h-full;
  }

  .calendar-cell-primary-date {
    @apply text-sm font-bold;
  }

  .calendar-cell-secondary-date {
    @apply text-xs;
  }

  .calendar-cell-events {
    @apply flex flex-col gap-0.5 mt-1 flex-1 overflow-hidden;
  }

  .calendar-cell-event {
    @apply block text-xs bg-blue-100 text-blue-800 p-0.5 rounded truncate max-h-4;
  }

  /* Show only first event */
  .calendar-cell-event:nth-child(n + 2) {
    @apply hidden;
  }

  /* Hide all indicators and badges when showing event titles */
  .calendar-cell-event-indicator {
    @apply hidden;
  }

  .calendar-cell-event-count {
    @apply hidden;
  }

  .calendar-cell-event-badge {
    @apply hidden;
  }
}

/* Very large cells (> 100px height) - show multiple events */
@container (min-height: 100px) {
  .calendar-cell-content {
    @apply flex-col h-full;
  }

  .calendar-cell-primary-date {
    @apply text-sm font-bold;
  }

  .calendar-cell-secondary-date {
    @apply text-xs;
  }

  .calendar-cell-secondary-month {
    @apply block;
  }

  .calendar-cell-events {
    @apply flex flex-col gap-1 mt-2 flex-1 overflow-hidden;
  }

  .calendar-cell-event {
    @apply block text-sm bg-blue-100 text-blue-800 p-1 rounded truncate max-h-5;
  }

  /* Show up to 3 events */
  .calendar-cell-event:nth-child(n + 4) {
    @apply hidden;
  }

  /* Hide all indicators and badges when showing event titles */
  .calendar-cell-event-indicator {
    @apply hidden;
  }

  .calendar-cell-event-count {
    @apply hidden;
  }

  .calendar-cell-event-badge {
    @apply hidden;
  }
}

/* Width-based adjustments */

/* Very narrow cells (< 60px width) */
@container (max-width: 60px) {
  .calendar-cell-secondary-month {
    @apply hidden;
  }

  .calendar-cell-event {
    @apply text-xs p-0.5;
  }
}

/* Narrow cells (60-80px width) */
@container (min-width: 60px) and (max-width: 80px) {
  .calendar-cell-secondary-month {
    @apply hidden;
  }

  .calendar-cell-event {
    @apply text-xs;
  }
}

/* Medium width cells (80-100px width) */
@container (min-width: 80px) and (max-width: 100px) {
  .calendar-cell-secondary-month {
    @apply hidden;
  }
}

/* Wide cells (> 100px width) - show everything */
@container (min-width: 100px) {
  .calendar-cell-secondary-month {
    @apply block;
  }
}

/* Overlapping month styling */
.calendar-cell.not-current-month {
  @apply opacity-50;
}

.calendar-cell.not-current-month .calendar-cell-primary-date,
.calendar-cell.not-current-month .calendar-cell-secondary-date {
  @apply text-gray-400 dark:text-gray-500;
}

/* Selected cell styling */
.calendar-cell.selected {
  @apply ring-2 ring-blue-500;
}

/* Hover effects */
.calendar-cell:hover {
  @apply bg-blue-50 dark:bg-blue-900;
}

/* Unified Responsive Layout Structure */
.calendar-responsive-layout {
  /* Default: Side-by-side layout for larger screens */
  display: grid;
  grid-template-columns: 2fr 1fr;
  grid-template-areas: 'calendar events';
  gap: 0.5rem;
  height: 100%; /* Force full height usage */
  min-height: 0; /* Allow shrinking */
}

.calendar-section {
  grid-area: calendar;
  min-height: 0; /* Allow content to shrink and scroll */
  overflow: hidden; /* Prevent expansion */
}

.events-section {
  grid-area: events;
  min-height: 0; /* Critical: Allow content to shrink and scroll */
  overflow: hidden; /* Prevent expansion beyond allocated grid space */
}

/* === RESPONSIVE BREAKPOINTS USING MEDIA QUERIES === */

/* Very small screens: Calendar only - only for extremely narrow screens */
@media (max-width: 360px) {
  .calendar-responsive-layout {
    grid-template-columns: 1fr;
    grid-template-rows: 1fr;
    grid-template-areas: 'calendar';
    gap: 0;
  }

  .events-section {
    display: none;
  }
}

/* Small screens in portrait: Stack vertically */
@media (max-width: 768px) and (max-aspect-ratio: 1) {
  .calendar-responsive-layout {
    grid-template-columns: 1fr;
    grid-template-rows: 2fr 1fr;
    grid-template-areas:
      'calendar'
      'events';
    gap: 0.75rem;
    height: 100%;
    min-height: 0;
  }
}

/* Small screens in landscape: Side by side with 2:1 ratio */
@media (max-width: 1024px) and (min-aspect-ratio: 1) {
  .calendar-responsive-layout {
    grid-template-columns: 2fr 1fr;
    grid-template-rows: 1fr;
    grid-template-areas: 'calendar events';
    gap: 0.5rem;
    height: 100%;
    min-height: 0;
  }
}

/* Medium screens in portrait: Stack vertically */
@media (min-width: 481px) and (max-width: 1024px) and (max-aspect-ratio: 0.8) {
  .calendar-responsive-layout {
    grid-template-columns: 1fr;
    grid-template-rows: 2fr 1fr;
    grid-template-areas:
      'calendar'
      'events';
    gap: 1rem;
    height: 100%;
    min-height: 0;
  }
}

/* Large screens: Standard side-by-side - excludes iPad portrait */
@media (min-width: 1367px) {
  .calendar-responsive-layout {
    grid-template-columns: 2fr 1fr;
    grid-template-rows: 1fr;
    grid-template-areas: 'calendar events';
    gap: 1.5rem;
    height: 100%;
    min-height: 0;
  }
}

/* Very wide screens: Keep 2:1 ratio */
@media (min-width: 1400px) {
  .calendar-responsive-layout {
    grid-template-columns: 2fr 1fr;
    gap: 2rem;
    height: 100%;
    min-height: 0;
  }
}

/* Specific mobile device targeting */
/* iPhone portrait */
@media (max-width: 428px) and (orientation: portrait) {
  .calendar-responsive-layout {
    grid-template-columns: 1fr;
    grid-template-rows: 2fr 1fr;
    grid-template-areas:
      'calendar'
      'events';
    gap: 0.5rem;
    height: 100%;
    min-height: 0;
  }

  .events-section {
    display: block; /* Ensure events section is visible */
  }
}

/* iPhone landscape */
@media (max-height: 428px) and (orientation: landscape) {
  .calendar-responsive-layout {
    grid-template-columns: 2fr 1fr;
    grid-template-areas: 'calendar events';
    gap: 0.5rem;
    height: 100%;
    min-height: 0;
  }
}

/* iPad portrait - includes iPad Pro 11" and 12.9" */
@media (min-width: 768px) and (max-width: 1366px) and (orientation: portrait) {
  .calendar-responsive-layout {
    grid-template-columns: 1fr;
    grid-template-rows: 2fr 1fr;
    grid-template-areas:
      'calendar'
      'events';
    gap: 1rem;
    height: 100%;
    min-height: 0;
  }
}

/* iPad landscape */
@media (min-width: 1024px) and (max-width: 1366px) and (orientation: landscape) {
  .calendar-responsive-layout {
    grid-template-columns: 2fr 1fr;
    grid-template-areas: 'calendar events';
    gap: 1rem;
    height: 100%;
    min-height: 0;
  }
}
